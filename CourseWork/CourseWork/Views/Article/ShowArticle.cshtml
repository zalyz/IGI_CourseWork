@using System.Security.Claims
@model CourseWork.Models.ArticleModels.ShowArticleViewModel

<div>
    <div>
        <h2>@Model.Article.Title</h2>
        <div class="p-2">
            <span>@Model.Article.Author.Name</span>
            <div>
                @Model.Article.Date.ToString("dd.MM.yyyy HH:mm")
            </div>
            <div>
                <span><img src="~/eyeIcon.png"/></span>
                <span>@Model.Article.NumberOfViews</span>
                <span><img src="~/comments.png"/></span>
                <span>@Model.ArticleComments.Count</span>
            </div>
        </div>
        <div>
            <img class="card-img-top" src="data:image/jpeg;base64,@Convert.ToBase64String(Model.Article.ImageBytes)" alt="Card image cap">
        </div>
        <div class="mt-3">
            <p class="text-md-left text-wrap">@Model.Article.Text</p>
        </div>
    </div>
    @if (User.Identity.IsAuthenticated)
    {
        <div>
            <form asp-antiforgery="true">
                <h3>Leav comment</h3>
                <p>From: <b>@User.Identity.Name</b></p>
                <div>
                    <span>Comment</span>
                    <textarea class="form-control w-100 text-dark" name="text" wrap="hard"></textarea>
                </div>
                <div class="d-flex justify-content-end">
                    <button class="btn btn-outline-success mt-3" type="submit"
                            asp-controller="Article"
                            asp-action="AddComment"
                            asp-route-articleId="@Model.Article.Id">
                        Save Comment
                    </button>
                </div>
            </form>
        </div>
    }
    @if (Model.ArticleComments.Any())
    {
        <div class="mt-4">
            <h3>Coments:</h3>
            @foreach (var item in Model.ArticleComments)
            {
                <div class="bg-white p-1 mb-2">
                    <span class="text-info">@item.DateTime.ToString("dd.MM.yyyy HH.mm")</span>
                    <span class="text-primary"> From: <b>@item.Author.Name</b> </span>
                    <p class="text fs-4">Text: @item.Text</p>
                </div>
            }
        </div>
    }
</div>